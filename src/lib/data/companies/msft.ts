import { CompanyModel, YearProjection } from "@/types";
import { transcriptInsights as msftTranscriptInsights } from "@/lib/data/transcripts/msft-transcript-data";

const projections: YearProjection[] = [
  {
    year: 2026,
    segmentRevenue: {
      "productivity": 137,
      "intelligent-cloud": 132,
      "personal-computing": 59,
    },
    totalRevenue: 328,
    fcfMargin: 0.255,
    fcf: 83.6,
    discountFactor: 0.918,
    presentValue: 76.7,
  },
  {
    year: 2027,
    segmentRevenue: {
      "productivity": 154,
      "intelligent-cloud": 163,
      "personal-computing": 64,
    },
    totalRevenue: 381,
    fcfMargin: 0.255,
    fcf: 97.2,
    discountFactor: 0.843,
    presentValue: 81.9,
  },
  {
    year: 2028,
    segmentRevenue: {
      "productivity": 171,
      "intelligent-cloud": 199,
      "personal-computing": 68,
    },
    totalRevenue: 438,
    fcfMargin: 0.26,
    fcf: 113.9,
    discountFactor: 0.774,
    presentValue: 88.2,
  },
  {
    year: 2029,
    segmentRevenue: {
      "productivity": 188,
      "intelligent-cloud": 238,
      "personal-computing": 72,
    },
    totalRevenue: 498,
    fcfMargin: 0.265,
    fcf: 132,
    discountFactor: 0.711,
    presentValue: 93.9,
  },
  {
    year: 2030,
    segmentRevenue: {
      "productivity": 204,
      "intelligent-cloud": 279,
      "personal-computing": 75,
    },
    totalRevenue: 558,
    fcfMargin: 0.27,
    fcf: 150.7,
    discountFactor: 0.653,
    presentValue: 98.4,
  },
  {
    year: 2031,
    segmentRevenue: {
      "productivity": 219,
      "intelligent-cloud": 321,
      "personal-computing": 78,
    },
    totalRevenue: 618,
    fcfMargin: 0.27,
    fcf: 166.9,
    discountFactor: 0.599,
    presentValue: 100,
  },
  {
    year: 2032,
    segmentRevenue: {
      "productivity": 234,
      "intelligent-cloud": 369,
      "personal-computing": 81,
    },
    totalRevenue: 684,
    fcfMargin: 0.27,
    fcf: 184.7,
    discountFactor: 0.55,
    presentValue: 101.6,
  },
  {
    year: 2033,
    segmentRevenue: {
      "productivity": 249,
      "intelligent-cloud": 421,
      "personal-computing": 84,
    },
    totalRevenue: 754,
    fcfMargin: 0.27,
    fcf: 203.6,
    discountFactor: 0.505,
    presentValue: 102.8,
  },
  {
    year: 2034,
    segmentRevenue: {
      "productivity": 265,
      "intelligent-cloud": 477,
      "personal-computing": 87,
    },
    totalRevenue: 829,
    fcfMargin: 0.27,
    fcf: 223.8,
    discountFactor: 0.464,
    presentValue: 103.8,
  },
  {
    year: 2035,
    segmentRevenue: {
      "productivity": 281,
      "intelligent-cloud": 536,
      "personal-computing": 90,
    },
    totalRevenue: 907,
    fcfMargin: 0.27,
    fcf: 244.9,
    discountFactor: 0.426,
    presentValue: 104.3,
  },
];

export const msftCompany: CompanyModel = {
  symbol: "MSFT",
  name: "Microsoft Corporation",
  description: "Productivity, cloud, and personal computing giant transitioning to AI-first platforms.",
  segments: [
    {
      id: "productivity",
      name: "Productivity & Business Processes",
      fy2025Revenue: 120.8,
      fy2024Revenue: 107,
      growthRate: 0.13,
      operatingMargin: 0.55,
      percentOfTotal: 42.9,
      components: [
        { name: "Office Commercial", revenue: 60, growthRate: 0.13 },
        { name: "Office Consumer", revenue: 8, growthRate: 0.05 },
        { name: "LinkedIn", revenue: 20, growthRate: 0.1 },
        { name: "Dynamics 365", revenue: 33, growthRate: 0.16 },
      ],
      growthDrivers: [
        "Copilot AI integration across Microsoft 365",
        "Security & compliance upsell within E5",
        "Dynamics digital transformation",
        "LinkedIn B2B engagement",
      ],
      challenges: [
        "Google Workspace competition",
        "ROI proof for Copilot pricing",
        "LinkedIn hiring softness",
      ],
      color: "#0078D4",
    },
    {
      id: "intelligent-cloud",
      name: "Intelligent Cloud",
      fy2025Revenue: 106.3,
      fy2024Revenue: 87.9,
      growthRate: 0.21,
      operatingMargin: 0.4,
      percentOfTotal: 37.7,
      components: [
        { name: "Azure & Cloud Services", revenue: 75, growthRate: 0.33 },
        { name: "Server Products", revenue: 20, growthRate: -0.03 },
        { name: "GitHub", revenue: 3, growthRate: 0.25 },
        { name: "Nuance", revenue: 3, growthRate: 0.12 },
        { name: "Enterprise Services", revenue: 5, growthRate: 0.02 },
      ],
      growthDrivers: [
        "Azure AI infrastructure buildout",
        "OpenAI partnership exclusivity",
        "Azure OpenAI Service adoption",
        "Fabric & unified data platform",
      ],
      challenges: [
        "$80B+ annual capex intensity",
        "Margin pressure from AI workloads",
        "AWS and Google competition",
        "GPU supply constraints",
      ],
      color: "#10B981",
    },
    {
      id: "personal-computing",
      name: "More Personal Computing",
      fy2025Revenue: 54.6,
      fy2024Revenue: 51,
      growthRate: 0.07,
      operatingMargin: 0.35,
      percentOfTotal: 19.4,
      components: [
        { name: "Windows OEM", revenue: 14, growthRate: 0 },
        { name: "Windows Commercial", revenue: 10, growthRate: 0.06 },
        { name: "Search & News Ads", revenue: 13, growthRate: 0.18 },
        { name: "Gaming", revenue: 21, growthRate: 0.05 },
        { name: "Devices", revenue: 6, growthRate: -0.05 },
      ],
      growthDrivers: [
        "Bing + Copilot share gains",
        "Xbox/Game Pass engagement",
        "Activision integration",
        "Windows 11 AI PC refresh",
      ],
      challenges: [
        "Mature PC demand",
        "Hardware losses",
        "Google search dominance",
        "Regulatory scrutiny",
      ],
      color: "#8B5CF6",
    },
  ],
  baseCaseDCF: {
    projections,
    wacc: 0.089,
    terminalGrowth: 0.035,
    terminalValue: 4694,
    pvTerminalValue: 2000,
    enterpriseValue: 2952,
    cash: 80,
    debt: 75,
    equityValue: 2957,
    sharesOutstanding: 7.43,
    fairValuePerShare: 398,
  },
  marketData: {
    currentPrice: 494,
    marketCap: 3670,
    sharesOutstanding: 7.43,
    dateUpdated: "2025-11-19",
  },
  recommendation: {
    rating: "HOLD",
    targetPrice: 398,
    upside: -0.19,
    suggestedEntry: [420, 450],
    catalysts: {
      positive: [
        "Azure AI capacity additions beat targets",
        "Copilot adoption exceeds 40% penetration",
        "Cloud margins rebound to 72%+",
        "Bing AI hits >5% U.S. share",
        "Gaming synergies >$1B annually",
      ],
      negative: [
        "AI monetization lags investment",
        "AWS/Google share gains",
        "Activision or AI regulation",
        "Prolonged capex drag on margins",
        "Enterprise IT slowdown",
      ],
    },
  },
  scenarios: {
    bull: {
      fairValue: 520,
      metrics: [
        { label: "Azure AI growth", value: "60%" },
        { label: "Copilot penetration", value: "60%" },
        { label: "Cloud margin", value: "75%" },
        { label: "Terminal growth", value: "4.0%" },
      ],
      narrative: "Capacity-led Azure upside and rapid Copilot monetization push MSFT into premium valuation territory.",
    },
    base: {
      fairValue: 398,
      metrics: [
        { label: "Azure AI growth", value: "40%" },
        { label: "Copilot penetration", value: "40%" },
        { label: "Cloud margin", value: "72%" },
        { label: "Terminal growth", value: "3.5%" },
      ],
      narrative: "Balanced AI demand with steady enterprise adoption keeps multiple near historical averages.",
    },
    bear: {
      fairValue: 300,
      metrics: [
        { label: "Azure AI growth", value: "25%" },
        { label: "Copilot penetration", value: "20%" },
        { label: "Cloud margin", value: "65%" },
        { label: "Terminal growth", value: "3.0%" },
      ],
      narrative: "AI supply/demand mismatches and macro pressure compress growth and multiples.",
    },
  },
  transcriptInsights: msftTranscriptInsights,
  theme: {
    iconLetter: "M",
    primaryColor: "#2563EB",
    accentColor: "#8B5CF6",
    segmentColors: {
      productivity: "#0078D4",
      "intelligent-cloud": "#10B981",
      "personal-computing": "#8B5CF6",
    },
  },
};
